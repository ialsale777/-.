// ØªØ¶ÙŠÙ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ø´ÙŠØª
function onOpen() {
  const ui = SpreadsheetApp.getUi();
  ui.createMenu('ğŸ“… Ø£Ø¯ÙˆØ§Øª Ù…Ø®ØµØµØ©')
    .addItem('Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª', 'showDateTimePicker')
    .addToUi();

  // Ù…Ø«Ø§Ù„ Ø¥Ø¶Ø§ÙÙŠ: ØªÙØ¹ÙŠÙ„ Ø¢Ø®Ø± Ø´ÙŠØª Ø¹Ù†Ø¯ Ø§Ù„ÙØªØ­ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
  /*
  const spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  const sheets = spreadsheet.getSheets();
  const lastSheet = sheets[sheets.length - 1];
  spreadsheet.setActiveSheet(lastSheet);
  */
}

// ØªØ¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª
function showDateTimePicker() {
  const html = HtmlService.createHtmlOutputFromFile('DateTimePicker')
    .setWidth(400)
    .setHeight(250);
  SpreadsheetApp.getUi().showModalDialog(html, 'Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª');
}

// ØªØ¶Ø¹ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª ÙÙŠ Ø§Ù„Ø®Ù„ÙŠØ© Ø§Ù„Ù†Ø´Ø·Ø©
function setDateTime(dateTime) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const cell = sheet.getActiveCell();
  cell.setValue(new Date(dateTime));
}
